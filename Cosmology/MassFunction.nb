(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      6973,        236]
NotebookOptionsPosition[      5777,        189]
NotebookOutlinePosition[      6236,        208]
CellTagsIndexPosition[      6193,        205]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Mass Functions", "Subtitle",
 CellChangeTimes->{{3.543239593924094*^9, 3.5432396092949677`*^9}}],

Cell["\<\
This is a collection of routines to compute mass functions. 
Based on M. White, ApJS 2002\
\>", "Text",
 CellChangeTimes->{{3.543239752969906*^9, 3.543239805762903*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Cosmology`MassFunction`\>\"", "]"}], "\n",
   "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Needs", " ", "statements", " ", "go", " ", "here"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Cosmology`Defs`\>\"", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "You", " ", "should", " ", "put", " ", "usage", " ", "statements", " ", 
    "here"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"deltac", "::", "usage"}], " ", "=", " ", 
  "\"\<deltac is the spherical collapse overdensity at z=0\>\""}], "\n", 
 RowBox[{
  RowBox[{"ShethTormen", "::", "usage"}], " ", "=", " ", 
  "\"\<ShethTormen[v] is the Sheth-Tormen multiplicity function\>\""}]}], \
"Code",
 CellChangeTimes->{{3.543239080347979*^9, 3.543239156102126*^9}, {
  3.543239397273192*^9, 3.543239424222596*^9}, {3.543239460800177*^9, 
  3.543239485087593*^9}}],

Cell[BoxData["\<\"Cosmology`MassFunction`\"\>"], "Output",
 CellChangeTimes->{{3.543239957858121*^9, 3.5432399582199583`*^9}}],

Cell[BoxData["\<\"deltac is the spherical collapse overdensity at z=0\"\>"], \
"Output",
 CellChangeTimes->{{3.543239957858121*^9, 3.543239958225041*^9}}],

Cell[BoxData["\<\"ShethTormen[v] is the Sheth-Tormen multiplicity \
function\"\>"], "Output",
 CellChangeTimes->{{3.543239957858121*^9, 3.543239958228998*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "private", " ", "section", " ", "of", " ", "the", " ", 
    "package", " ", "is", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}]], "Code",
 CellChangeTimes->{{3.5432391242226267`*^9, 3.54323913123664*^9}, {
  3.54323916475558*^9, 3.543239182101027*^9}}],

Cell[BoxData["\<\"Cosmology`MassFunction`Private`\"\>"], "Output",
 CellChangeTimes->{{3.543239958020124*^9, 3.5432399582701607`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deltac", " ", "=", " ", "1.686"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Generic", " ", "functional", " ", "form"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vfv", "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "*", 
         RowBox[{"v", "^", "2"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "p"}], ")"}]}]}], ")"}], " ", "*", " ", 
    RowBox[{"Sqrt", "[", " ", 
     RowBox[{"a", "*", 
      RowBox[{"v", "^", "2"}]}], "]"}], " ", "*", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", " ", "a"}], "*", 
      RowBox[{
       RowBox[{"v", "^", "2"}], "/", "2"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ShethTormen", "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"vfv", "[", "v", "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", "->", " ", "0.707"}], ",", " ", 
      RowBox[{"p", "->", " ", "0.3"}]}], "}"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{3.54323950088335*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Code",
 CellChangeTimes->{{3.543239190184836*^9, 3.543239197914954*^9}}],

Cell[BoxData["\<\"Cosmology`MassFunction`Private`\"\>"], "Output",
 CellChangeTimes->{{3.54323995808674*^9, 3.543239958353166*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.543239331085164*^9, 3.543239344634115*^9}}],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.543239851763549*^9, 3.543239870509886*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShethTormen", "[", "x", "]"}]], "Input",
 CellChangeTimes->{{3.543239873357617*^9, 3.543239878543096*^9}}],

Cell[BoxData[
 RowBox[{"0.8408329203831163`", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "0.3535`"}], " ", 
    SuperscriptBox["x", "2"]}]], " ", 
  SqrtBox[
   SuperscriptBox["x", "2"]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox["1.1096197442950755`", 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["x", "2"], ")"}], "0.3`"]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5432399584494677`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShethTormen", "[", "x", "]"}]], "Input",
 CellChangeTimes->{{3.5432399827375393`*^9, 3.543239988257189*^9}}],

Cell[BoxData[
 RowBox[{"0.8408329203831163`", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "0.3535`"}], " ", 
    SuperscriptBox["x", "2"]}]], " ", 
  SqrtBox[
   SuperscriptBox["x", "2"]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox["1.1096197442950755`", 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["x", "2"], ")"}], "0.3`"]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.543239989453845*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{740, 620},
WindowMargins->{{39, Automatic}, {Automatic, 3}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 102, 1, 46, "Subtitle"],
Cell[684, 25, 179, 4, 41, "Text"],
Cell[CellGroupData[{
Cell[888, 33, 906, 22, 149, "Code"],
Cell[1797, 57, 126, 1, 27, "Output"],
Cell[1926, 60, 154, 2, 27, "Output"],
Cell[2083, 64, 159, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2279, 71, 367, 8, 59, "Code"],
Cell[2649, 81, 134, 1, 27, "Output"]
}, Open  ]],
Cell[2798, 85, 1154, 35, 104, "Code"],
Cell[CellGroupData[{
Cell[3977, 124, 160, 3, 59, "Code"],
Cell[4140, 129, 131, 1, 27, "Output"]
}, Open  ]],
Cell[4286, 133, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[4403, 138, 92, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[4520, 143, 130, 2, 27, "Input"],
Cell[4653, 147, 457, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5147, 166, 132, 2, 27, "Input"],
Cell[5282, 170, 455, 14, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
